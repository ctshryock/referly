This is a work in progress. Pull requests are welcomed.